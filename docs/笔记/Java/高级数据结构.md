## âœ… ä¸€ã€Trieï¼ˆå­—å…¸æ ‘ï¼‰â€”â€” å­—ç¬¦ä¸²å‰ç¼€åŒ¹é…

### ğŸ“Œ ç”¨é€”ï¼š

- è‡ªåŠ¨è¡¥å…¨ï¼ˆæœç´¢æ¡†ï¼‰
- æ‹¼å†™æ£€æŸ¥
- å•è¯æŸ¥æ‰¾
- [LeetCode 208] å®ç° Trie (å‰ç¼€æ ‘)

```java
/**
 * å­—å…¸æ ‘ï¼ˆTrieï¼‰
 */
public class Trie {
    private final TrieNode root;

    static class TrieNode {
        TrieNode[] children = new TrieNode[26]; // å‡è®¾åªæœ‰å°å†™å­—æ¯ a-z
        boolean isEnd; // æ ‡è®°æ˜¯å¦æ˜¯ä¸€ä¸ªå®Œæ•´å•è¯çš„ç»“å°¾
    }

    public Trie() {
        this.root = new TrieNode();
    }

    /**
     * æ’å…¥ä¸€ä¸ªå•è¯
     */
    public void insert(String word) {
        TrieNode node = root;
        for (char c : word.toCharArray()) {
            int idx = c - 'a';
            if (node.children[idx] == null) {
                node.children[idx] = new TrieNode();
            }
            node = node.children[idx];
        }
        node.isEnd = true;
    }

    /**
     * æŸ¥æ‰¾å•è¯æ˜¯å¦å­˜åœ¨
     */
    public boolean search(String word) {
        TrieNode node = searchPrefix(word);
        return node != null && node.isEnd;
    }

    /**
     * åˆ¤æ–­æ˜¯å¦æœ‰ä»¥è¯¥å‰ç¼€å¼€å¤´çš„å•è¯
     */
    public boolean startsWith(String prefix) {
        return searchPrefix(prefix) != null;
    }

    private TrieNode searchPrefix(String prefix) {
        TrieNode node = root;
        for (char c : prefix.toCharArray()) {
            int idx = c - 'a';
            if (node.children[idx] == null) {
                return null;
            }
            node = node.children[idx];
        }
        return node;
    }

    // æµ‹è¯•
    public static void main(String[] args) {
        Trie trie = new Trie();
        trie.insert("apple");
        System.out.println(trie.search("apple"));   // true
        System.out.println(trie.search("app"));     // false
        System.out.println(trie.startsWith("app")); // true
        trie.insert("app");
        System.out.println(trie.search("app"));     // true
    }
}
```

> ğŸ’¡ æ‰©å±•ï¼šæ”¯æŒæ‰€æœ‰å­—ç¬¦ï¼Ÿå¯ç”¨ `Map<Character, TrieNode>` æ›¿ä»£æ•°ç»„ã€‚

---

## âœ… äºŒã€Union-Findï¼ˆå¹¶æŸ¥é›†ï¼‰â€”â€” è”é€šæ€§é—®é¢˜

```java
/**
 * å¹¶æŸ¥é›†ï¼ˆUnion-Find / Disjoint Set Union, DSUï¼‰
 */
public class UnionFind {
    private final int[] parent;
    private final int[] rank;
    private int count;

    public UnionFind(int n) {
        this.count = n;
        this.parent = new int[n];
        this.rank = new int[n];
        for (int i = 0; i < n; i++) {
            parent[i] = i;
            rank[i] = 1;
        }
    }

    /**
     * æŸ¥æ‰¾æ ¹èŠ‚ç‚¹ï¼ˆå¸¦è·¯å¾„å‹ç¼©ï¼‰
     */
    public int find(int x) {
        if (parent[x] != x) {
            parent[x] = find(parent[x]); // è·¯å¾„å‹ç¼©
        }
        return parent[x];
    }

    /**
     * åˆå¹¶ä¸¤ä¸ªé›†åˆï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰
     */
    public void union(int x, int y) {
        int rootX = find(x);
        int rootY = find(y);
        if (rootX == rootY) return;

        if (rank[rootX] < rank[rootY]) {
            parent[rootX] = rootY;
        } else if (rank[rootX] > rank[rootY]) {
            parent[rootY] = rootX;
        } else {
            parent[rootY] = rootX;
            rank[rootX]++;
        }
        count--;
    }

    /**
     * æ˜¯å¦è¿é€š
     */
    public boolean connected(int x, int y) {
        return find(x) == find(y);
    }

    /**
     * è·å–è¿é€šåˆ†é‡æ•°é‡
     */
    public int getCount() {
        return count;
    }

    /**
     * è·å–æŸä¸ªå…ƒç´ æ‰€åœ¨é›†åˆçš„å¤§å°ï¼ˆéœ€é¢å¤–ç»´æŠ¤ size æ•°ç»„æ‰å‡†ç¡®ï¼‰
     * è¿™é‡Œåªæ˜¯è¿”å›æ ¹èŠ‚ç‚¹çš„ rankï¼ˆè¿‘ä¼¼å€¼ï¼‰
     */
    public int getSize(int x) {
        int root = find(x);
        return rank[root]; // æ³¨æ„ï¼šè¿™ä¸æ˜¯ç²¾ç¡®å¤§å°ï¼Œä»…ä½œå‚è€ƒ
    }

    // æµ‹è¯•
    public static void main(String[] args) {
        UnionFind uf = new UnionFind(10); // åˆ›å»º 10 ä¸ªèŠ‚ç‚¹ï¼š0 ~ 9

        // æ„å»ºç¬¬ä¸€ä¸ªè¿é€šåˆ†é‡ï¼š0-1-2
        uf.union(0, 1);
        uf.union(1, 2);

        // ç¬¬äºŒä¸ªè¿é€šåˆ†é‡ï¼š3-4
        uf.union(3, 4);

        // ç¬¬ä¸‰ä¸ªè¿é€šåˆ†é‡ï¼š5-6-7-8-9
        uf.union(5, 6);
        uf.union(6, 7);
        uf.union(7, 8);
        uf.union(8, 9);

        System.out.println("0 å’Œ 2 è¿é€š: " + uf.connected(0, 2));     // true
        System.out.println("0 å’Œ 9 è¿é€š: " + uf.connected(0, 9));     // false
        System.out.println("è¿é€šåˆ†é‡ä¸ªæ•°: " + uf.getCount());          // åº”è¯¥æ˜¯ 3

        // å†è¿æ¥ä¸€ä¸‹è¯•è¯•
        uf.union(2, 3); // æŠŠ 0-1-2 å’Œ 3-4 è¿èµ·æ¥ â†’ ç°åœ¨ 0,1,2,3,4 è¿é€š
        System.out.println("0 å’Œ 4 è¿é€š: " + uf.connected(0, 4));     // true
        System.out.println("è¿é€šåˆ†é‡ä¸ªæ•°: " + uf.getCount());          // åº”è¯¥æ˜¯ 2
    }
}
```

> ğŸ” æç¤ºï¼šè‹¥è¦ç²¾ç¡®ç»Ÿè®¡æ¯ä¸ªé›†åˆå¤§å°ï¼Œå¯ç”¨ `size[]` æ•°ç»„ä»£æ›¿ `rank[]`ï¼Œæˆ–åŒæ—¶ç»´æŠ¤ä¸¤è€…ã€‚

---

## âœ… ä¸‰ã€Fenwick Treeï¼ˆæ ‘çŠ¶æ•°ç»„ / BITï¼‰

### ğŸ“Œ ç”¨é€”ï¼š

- åŠ¨æ€å‰ç¼€å’ŒæŸ¥è¯¢
- å•ç‚¹æ›´æ–° + åŒºé—´æŸ¥è¯¢ï¼ˆå¦‚é€†åºå¯¹ï¼‰
- æ—¶é—´å¤æ‚åº¦ï¼šO(log n) æ›´æ–°ä¸æŸ¥è¯¢
- ç©ºé—´ç´§å‡‘ï¼Œä»£ç çŸ­

```java
/**
 * æ ‘çŠ¶æ•°ç»„ï¼ˆFenwick Tree / Binary Indexed Treeï¼‰
 * æ”¯æŒå•ç‚¹æ›´æ–°å’Œå‰ç¼€å’ŒæŸ¥è¯¢
 */
public class FenwickTree {
    private final int[] tree;
    private final int n;

    public FenwickTree(int size) {
        this.n = size + 1; // ä¸‹æ ‡ä»1å¼€å§‹
        this.tree = new int[n];
    }

    /**
     * lowbit: å–äºŒè¿›åˆ¶æœ€ä½ä½çš„1
     */
    private int lowbit(int x) {
        return x & (-x);
    }

    /**
     * åœ¨ä½ç½® i ä¸Šå¢åŠ  deltaï¼ˆi ä» 1 å¼€å§‹ï¼‰
     */
    public void update(int i, int delta) {
        while (i < n) {
            tree[i] += delta;
            i += lowbit(i);
        }
    }

    /**
     * æŸ¥è¯¢å‰ç¼€å’Œ [1, i]
     */
    public int query(int i) {
        int sum = 0;
        while (i > 0) {
            sum += tree[i];
            i -= lowbit(i);
        }
        return sum;
    }

    /**
     * æŸ¥è¯¢åŒºé—´å’Œ [left, right]ï¼ˆé—­åŒºé—´ï¼Œä¸‹æ ‡ä»1èµ·ï¼‰
     */
    public int rangeQuery(int left, int right) {
        return query(right) - query(left - 1);
    }

    // æµ‹è¯•
    public static void main(String[] args) {
        int[] arr = {1, 3, 5, 7, 9, 11};
        FenwickTree ft = new FenwickTree(arr.length);

        // åˆå§‹åŒ–
        for (int i = 0; i < arr.length; i++) {
            ft.update(i + 1, arr[i]);
        }

        System.out.println("å‰ç¼€å’Œ[1~3]: " + ft.query(3));           // 1+3+5=9
        System.out.println("åŒºé—´å’Œ[2~4]: " + ft.rangeQuery(2, 4));   // 3+5+7=15

        ft.update(3, 2); // ç»™ç¬¬3ä¸ªæ•°åŠ 2 â†’ 5â†’7
        System.out.println("æ›´æ–°ååŒºé—´å’Œ[2~4]: " + ft.rangeQuery(2, 4)); // 3+7+7=17
    }
}
```

> âš ï¸ æ³¨æ„ï¼šé€šå¸¸è¾“å…¥æ•°ç»„ç´¢å¼•ä» 1 å¼€å§‹å¤„ç†æ›´æ–¹ä¾¿ã€‚

---

## âœ… å››ã€Segment Treeï¼ˆçº¿æ®µæ ‘ï¼‰

### ğŸ“Œ ç”¨é€”ï¼š

- åŒºé—´æŸ¥è¯¢ï¼ˆæœ€å¤§å€¼ã€æœ€å°å€¼ã€å’Œç­‰ï¼‰
- æ”¯æŒåŒºé—´æ›´æ–°ï¼ˆæ‡’æ ‡è®°ï¼‰ã€å•ç‚¹æ›´æ–°
- æ›´çµæ´»ä½†ä»£ç è¾ƒé•¿

è¿™é‡Œå®ç°ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬ï¼š**æ”¯æŒåŒºé—´æ±‚å’Œ + å•ç‚¹æ›´æ–°**

```java
/**
 * çº¿æ®µæ ‘ï¼ˆSegment Treeï¼‰â€”â€” åŒºé—´å’ŒæŸ¥è¯¢ + å•ç‚¹æ›´æ–°
 */
public class SegmentTree {
    private final int[] tree; // å­˜å‚¨çº¿æ®µæ ‘èŠ‚ç‚¹å€¼
    private final int n;

    public SegmentTree(int[] arr) {
        this.n = arr.length;
        this.tree = new int[4 * n]; // ä¸€èˆ¬å¼€ 4 å€ç©ºé—´
        build(arr, 0, 0, n - 1);
    }

    /**
     * æ„å»ºçº¿æ®µæ ‘
     * node: å½“å‰èŠ‚ç‚¹ç¼–å·
     * start, end: å½“å‰èŠ‚ç‚¹è¡¨ç¤ºçš„åŒºé—´
     */
    private void build(int[] arr, int node, int start, int end) {
        if (start == end) {
            tree[node] = arr[start];
        } else {
            int mid = start + (end - start) / 2;
            int leftNode = 2 * node + 1;
            int rightNode = 2 * node + 2;

            build(arr, leftNode, start, mid);
            build(arr, rightNode, mid + 1, end);
            tree[node] = tree[leftNode] + tree[rightNode];
        }
    }

    /**
     * æ›´æ–°å•ç‚¹å€¼ï¼šarr[index] += delta
     */
    public void update(int index, int delta) {
        update(0, 0, n - 1, index, delta);
    }

    private void update(int node, int start, int end, int idx, int delta) {
        if (start == end) {
            tree[node] += delta;
        } else {
            int mid = start + (end - start) / 2;
            if (idx <= mid) {
                update(2 * node + 1, start, mid, idx, delta);
            } else {
                update(2 * node + 2, mid + 1, end, idx, delta);
            }
            tree[node] = tree[2 * node + 1] + tree[2 * node + 2];
        }
    }

    /**
     * æŸ¥è¯¢åŒºé—´å’Œ [left, right]
     */
    public int query(int left, int right) {
        return query(0, 0, n - 1, left, right);
    }

    private int query(int node, int start, int end, int L, int R) {
        if (R < start || L > end) return 0;
        if (L <= start && end <= R) return tree[node];

        int mid = start + (end - start) / 2;
        int leftSum = query(2 * node + 1, start, mid, L, R);
        int rightSum = query(2 * node + 2, mid + 1, end, L, R);
        return leftSum + rightSum;
    }

    // æµ‹è¯•
    public static void main(String[] args) {
        int[] arr = {1, 3, 5, 7, 9, 11};
        SegmentTree st = new SegmentTree(arr);

        System.out.println("åˆå§‹[1~3]å’Œ: " + st.query(1, 3)); // 3+5+7=15
        st.update(2, 2); // ç¬¬2ä¸ªä½ç½®ï¼ˆå³ arr[2]=5ï¼‰åŠ 2 â†’ å˜æˆ7
        System.out.println("æ›´æ–°å[1~3]å’Œ: " + st.query(1, 3)); // 3+7+7=17
    }
}
```

> ğŸ”§ è¿›é˜¶å¯æ‰©å±•ï¼š
> - æ”¯æŒæ‡’æ ‡è®°ï¼ˆLazy Propagationï¼‰å®ç°åŒºé—´æ›´æ–°
> - æ”¹ä¸ºç»´æŠ¤æœ€å¤§å€¼/æœ€å°å€¼/ä¼—æ•°ç­‰

---

## ğŸ“Š å››å¤§æ•°æ®ç»“æ„å¯¹æ¯”æ€»ç»“

| ç»“æ„               | ä¸»è¦ç”¨é€”        | æ—¶é—´å¤æ‚åº¦ï¼ˆå…¸å‹æ“ä½œï¼‰                | æ˜¯å¦å†…ç½®   |
|------------------|-------------|----------------------------|--------|
| **Trie**         | å­—ç¬¦ä¸²å‰ç¼€åŒ¹é…     | æ’å…¥/æŸ¥è¯¢: O(L), L=å­—ç¬¦ä¸²é•¿åº¦       | âŒ æ‰‹åŠ¨å®ç° |
| **UnionFind**    | è”é€šæ€§ã€åŠ¨æ€è¿é€šåˆ†é‡  | find/union: O(Î±(n)) â‰ˆ O(1) | âŒ æ‰‹åŠ¨å®ç° |
| **Fenwick Tree** | å‰ç¼€å’Œã€é€†åºå¯¹     | æ›´æ–°/æŸ¥è¯¢: O(log n)            | âŒ æ‰‹åŠ¨å®ç° |
| **Segment Tree** | åŒºé—´æœ€å€¼/å’Œã€èŒƒå›´æŸ¥è¯¢ | æ„å»º O(n), æŸ¥è¯¢/æ›´æ–° O(log n)    | âŒ æ‰‹åŠ¨å®ç° |

---

## âœ… ä½¿ç”¨å»ºè®®

| åœºæ™¯            | æ¨èç»“æ„                            |
|---------------|---------------------------------|
| ç»Ÿè®¡é€†åºå¯¹         | `Fenwick Tree`                  |
| åŠ¨æ€å‰ç¼€å’Œ         | `Fenwick Tree` æˆ– `Segment Tree` |
| åŒºé—´æœ€å€¼æŸ¥è¯¢        | `Segment Tree`                  |
| å­—ç¬¦ä¸²å‰ç¼€æœç´¢       | `Trie`                          |
| åˆ¤æ–­è¿é€šæ€§ï¼ˆå²›å±¿ã€æœ‹å‹åœˆï¼‰ | `UnionFind`                     |

---

## ğŸ¯ æ€»ç»“

- `Trie`ï¼šå­—ç¬¦ä¸²å‰ç¼€ç¥å™¨
- `UnionFind`ï¼šå¤„ç†å›¾è¿é€šæ€§
- `Fenwick Tree`ï¼šé«˜æ•ˆå‰ç¼€å’Œ
- `Segment Tree`ï¼šå¼ºå¤§åŒºé—´æŸ¥è¯¢
