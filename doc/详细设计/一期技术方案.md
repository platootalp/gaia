# 大模型应用平台 · 一期技术方案（MVP）

> **版本**: v0.1 &nbsp;&nbsp; **编写日期**: 2025-05-19

---

## 1. 项目概述

### 1.1 背景

- 公司计划推出一款 **低代码大模型应用平台**，帮助业务团队快速组合 _模型 · Agent · 插件 · 知识库_ 来构建 AI 应用。
- 一期目标：交付 **最小可用闭环**，内部灰度验证与收集反馈。

### 1.2 项目目标 & 收益

| 目标                      | 关键指标                       | 业务收益           |
|-------------------------|----------------------------|----------------|
| 打通「创建 → 调试 → 发布 → 对话」闭环 | TTV<sup>①</sup> < 10 min   | 显著降低 AI 应用交付门槛 |
| 单租户 + 单模型正式运行           | 支撑 50 QPS & 10K daily msgs | 内部团队率先落地增值场景   |

> ① Time-To-Value：从创建应用到拿到首个 AI 响应的时长

### 1.3 名词解释（节选）

| 缩写         | 含义                                    |
|------------|---------------------------------------|
| **Agent**  | 封装 Prompt、插件、RAG 的可执行单元               |
| **Plugin** | 以 OpenAPI/JSON-Schema 描述的外部工具         |
| **RAG**    | Retrieval-Augmented Generation，检索增强生成 |

---

## 2. 系统分析

### 2.1 MVP 业务流程

```mermaid
flowchart LR
    A[创建 App] --> B[绑定 Agent]
    B --> C[调试对话]
    C --> D[发布渠道]
    D -->|Slack 调用| E[用户提问]
    E --> F[Agent -> 模型/插件/RAG]
    F --> G[响应 & 日志]
````

### 2.2 MVP 用例图

![use-case](./imgs/usecase-mvp.svg) <!-- 占位 -->

### 2.3 逻辑架构（MVP）

![logic-arch](./imgs/logic-arch-mvp.svg)

### 2.4 领域模型（核心聚合）

* **ModelAggregate**：id, provider, version
* **AgentAggregate**：id, profile, runtimePolicy
* **PluginAggregate**：id, schema, authConfig
* **KnowledgeBaseAggregate**：id, index, docs

---

## 3. 系统建设要素

### 3.1 MVP 应用架构图

![app-arch](./imgs/app-arch-mvp.svg)

### 3.2 关键接口（节选）

| 域     | Path               | 方式   | 描述       |
|-------|--------------------|------|----------|
| Agent | `POST /api/agents` | REST | 创建 Agent |
| Chat  | `POST /api/chat`   | REST | 会话消息发送   |

### 3.3 核心表/集合（节选）

```sql
CREATE TABLE agent (
  id BIGINT PRIMARY KEY,
  name VARCHAR(64),
  profile JSON NOT NULL,
  status VARCHAR(16) NOT NULL,
  created_time DATETIME,
  updated_time DATETIME
);
```

* **向量库**：`kb_<tenantId>` collection，dimension=1536

### 3.4 日志 & 监控

* **Log**: `agent.log`, `plugin.log` → Loki
* **Metrics**: QPS, Latency, Tokens → Prometheus + Grafana

---

## 4. 非功能设计（MVP 范围）

| 清单   | 方案摘要                               |
|------|------------------------------------|
| 稳定性  | 单副本 → 蓝绿；限流 50 QPS                 |
| 安全性  | JWT + RBAC；Prompt Injection 检测     |
| 性能   | 95p 延迟 ≤ 2 s；单 request ≤ 4k tokens |
| 上线策略 | Dev → Staging → 内部灰度(10%) → 全量     |

---

## 5.任务分解

| Sprint  | 关键交付                     | 截止   |
|---------|--------------------------|------|
| S1 (2w) | 模型接入、Agent CRUD、Chat API | 6-06 |
| S2 (2w) | 插件执行、知识库索引、日志 MVP        | 6-20 |
| S3 (1w) | 发布渠道、灰度开关、监控面板           | 6-27 |
| S4 (1w) | 压测 & Bugfix、上线           | 7-04 |

---

## 6. 技术评审

* **评审时间**：2025-05-30
* **评审重点**：MVP 功能闭环 & 部署可行性
* **预期结论**：同意按 4-Sprint 节奏投产，安全与成本风险可控。
